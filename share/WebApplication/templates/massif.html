{# -*- engine: jinja2 -*- #}
{% extends "base.html" %}
{% block body %}
  <ul class="breadcrumb">
    <li><a href="/main">Accueil</a></li>
    <li class="active">{{ massif.massif }}</li>
  </ul>

  <div class="row">
    <div class="col-xl-12">
      <h2>{{ massif.secteur }} ~ {{ massif.massif }} {% if massif.nom %} ~ {{ massif.nom }}{% endif %}</h2>
      <p><a href="/main/geoportail/{{ massif.massif }}">Géoportail</a></p>
      <h3>Accés</h3>
      <dl>
	<dt>Accés en voiture</dt>
	<dd>
	  {{ massif.acces }}
	  <br><a href="{{ massif.itineraire }}">Itineraire Google Map</a>
	</dd>
        <dt>Accés à vélo {% if massif.a_pieds %}/ à pieds{% endif %}</dt>
	<dd>{{ massif.velo }}</dd>
      </dl>
      <h3>Informations</h3>
      <dl>
	<dt>Coordonnée WGS 84 (<a href="http://spatialreference.org/ref/epsg/wgs-84/">EPSG:4326</a>)</dt>
	<dd>longitude, latitude = {{ massif.coordonne }}</dd>
	<dt>Coordonnée Mercator (<a href="http://spatialreference.org/ref/sr-org/epsg3857-wgs84-web-mercator-auxiliary-sphere/">EPSG:3857</a>)</dt>
	{% with mercator = massif.coordonne.mercator %}
	  <dd>({{ mercator[0] | round | int }}, {{ mercator[1] | round | int }}) m</dd>
	{% endwith %}
        <dt>Parcelles ONF</dt><dd>{{ massif.parcelles }}</dd>
        <dt>Rendez-vous Gums</dt><dd>{{ massif.rdv }}</dd>
        <dt>Point d'eau</dt><dd>{{ massif.point_deau }}</dd>
        <dt>Notes</dt><dd>{{ massif.notes }}</dd>
	<dt>Type de chaos</dt><dd>{{ massif.type_de_chaos }}</dd>
      </dl>
      <h3>Circuits</h3>
      <table class="table table-sm">
	<col style="width:5%">
	<col style="width:5%">
	<col style="width:10%">
	<col style="width:80%">
	<tbody>
	  {% for circuit in massif %}
	    <tr>
	      <td>{{ circuit.cotation }}</td>
	      <td>N° {{ circuit.numero }}</td>
	      <td>{{ circuit.couleur }}</td>
	      <td>
		{% for topo in circuit.topos %}
		  <a href="{{ topo }}">{{ topo|truncate(70) }}</a><br>
		{% endfor %}
	      </td>
	    </tr>
	  {% endfor %}
	</tbody>
      </table>
      <h3>Massifs à proximité</h3>
      <div class="alert alert-info" role="alert">
	critère: 2 km à vol d'oiseau, donc prévoir plus long!
      </div>
      {% with massif_voisins = massif.nearest(number_of_items=100, distance_max=2000) %}
	{% if massif_voisins %}
	  <table class="table table-sm">
	    <col style="width:10%">
	    <tbody>
	      {% for massif_ in massif_voisins %}
		<tr>
		  <td class="text-right">{{ massif.distance_to(massif_) | round | int }} m</td>
		  <td/>
		  <td><a href="/main/massif/{{ massif_.massif }}">{{ massif_.massif }}</a></td>
		  <td>
		    <ul class="list-inline">
		      {% for circuit in massif_ %}
			<li>{{ circuit.cotation }}</li>
		      {% endfor %}
		    </ul>
		  </td>
		</tr>
	      {% endfor %}
	    </tbody>
	  </table>
	{% else %}
	  <p>aucun</p>
	{% endif %}
      {% endwith %}
    </div>
  </div>
{% endblock %}
