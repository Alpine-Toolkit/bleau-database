{# -*- engine: jinja2 -*- #}
{% extends "include/base.html" %}

{% block title %} - {{ person.name }}{% endblock %}

{% block breadcrumb_li %}
  <li><a href="{{ url('person.index') }}">Personnes</a> </li>
  <li class="active">{{ person.name }}</li>
{% endblock %}

{% block content %}
  <h1> {{ person.name }}
    <div class="btn-group m-b-1" role="group">
      <a role="button" class="btn btn-primary" href="{{ url('person.update', person.pk) }}">
	<i class="fa fa-pencil-square-o"></i></a>
      <a role="button" class="btn btn-danger" data-toggle="modal" data-target="#deletePersonModal">
	<i class="fa fa-trash"></i></a>
    </div>
  </h1>

  <div class="modal fade" id="deletePersonModal" tabindex="-1" role="dialog" aria-labelledby="deletePersonModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
	  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span></button>
          <h3 class="modal-title" id="deletePersonModalLabel">{{ _("Delete person") }}</h3>
        </div>
        <div class="modal-body">
          <p>{{ _("Are you sure you want to delete this person?") }}</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">{{ _("Cancel") }}</button>
          <a role="button" class="btn btn-danger" href="{{ url('person.delete', person.pk) }}">{{ _("Delete person") }}</a>
        </div>
      </div>
    </div>
  </div>

  <h2>Circuits Ouverts</h2>
  <ul>
    {% from "include/information-macros.html" import circuit_openers %}
    {% for circuit in person.opened_circuits %}
      <li class="m-b-1">
	<a href="{{ url("circuit.details", circuit.pk) }}">
	  {{ circuit.massif.name }} {{  _("N°") }} {{ circuit.number }} {{ circuit.grade }}</a>
	<br>
	{% if circuit.creation_date %}
	  {{ circuit.creation_date }}
	{% endif %}
	{{ circuit_openers(circuit) }}
	{#
	{% if circuit.openers.affiliation %}
	  {{ circuit.openers.affiliation }}
	{% endif %}
	#}
      </li>
      {% else %}
      aucun
    {% endfor %}
  </ul>

  <h2>Réfections de Circuits <i class="fa fa-paint-brush"></i></h2>
  <ul>
    {% for refection in person.refections %}
      {% with circuit = refection.circuit %}
	<li class="m-b-1">
	  <a href="{{  url("refection.details", circuit.pk) }}">
	    {{ refection.date }} {{ circuit.massif.name }} {{  _("N°") }} {{ circuit.number }} {{ circuit.grade }}</a>
	</li>
      {% endwith %}
      {% else %}
      aucun
    {% endfor %}
  </ul>

{% endblock %}
